<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Simple Simon</title>
    <style>
        .block {
            width: 150px;
            height: 150px;
            margin: 10px;
            overflow: hidden;
        }
        .top, .bottom {
            display: flex;
            justify-content: center;
        }
        .topRight {
            border-top-right-radius: 100%;
        }
        .topLeft{
            border-top-left-radius: 100%;
        }
        .bottomLeft{
            border-bottom-left-radius: 100%;
        }
        .bottomRight{
            border-bottom-right-radius: 100%;
        }
        .circle {
            position: absolute;
            width: 140px;
            height: 140px;
            border-radius: 50%;
            background: white;
            bottom: 99px;
            left: 374px;
        }
        .red {
            background: red;
        }
        .blue {
            background: blue;
        }
        .yellow {
            background: yellow;
        }
        .green {
            background: green;
        }
        .muteRed {
            background: #D97273;
        }
        .muteBlue {
            background: #9acfea;
        }
        .muteYellow {
            background: khaki;
        }
        .muteGreen {
            background: #6CA559;
        }
        #game{
            position: relative;
        }
    </style>
</head>
<body>
<div id="game">
    <div class="top">
        <div class="block muteRed topLeft" id="red"></div>
        <div class="block muteBlue topRight" id="blue"></div>
    </div>
    <div class="circle"></div>
    <div class="bottom">
        <div class="block muteYellow bottomLeft" id="yellow"></div>
        <div class="block muteGreen bottomRight" id="green"></div>
    </div>
</div>
<div id="html"></div>
<button>Play Again?</button>


<script src="js/jquery-2.2.4.js"></script>
<script>
let colorsArray = ["blue", "yellow", "green", "red"];
let simonArray = [];
let simonCheck = [];
let red = $("#red");
let blue = $("#blue");
let green = $("#green");
let yellow = $("#yellow");
$("button").hide();

let getRandomColor = () => colorsArray[Math.floor((Math.random()*4))];
red.mouseup(() => {
    simonCheck.push("red");
    red.toggleClass("muteRed red");
    checkSimon();
});
blue.mouseup(() => {
    simonCheck.push("blue");
    blue.toggleClass("muteBlue blue");
    checkSimon();
});
yellow.mouseup(() => {
    simonCheck.push("yellow");
    yellow.toggleClass("muteYellow yellow");
    checkSimon();
});
green.mouseup(() => {
    simonCheck.push("green");
    green.toggleClass("muteGreen green");
    checkSimon();
});
red.mousedown(() => red.toggleClass("muteRed red"));
blue.mousedown(() => blue.toggleClass("muteBlue blue"));
yellow.mousedown(() => yellow.toggleClass("muteYellow yellow"));
green.mousedown(() => green.toggleClass("muteGreen green"));

let simonGame = (color) => {

        switch (color) {
            case "red":
                setTimeout(() => red.toggleClass("muteRed red"),500);
                red.toggleClass("muteRed red");
                break;
            case "blue":
                setTimeout(() => blue.toggleClass("muteBlue blue"),500);
                blue.toggleClass("muteBlue blue");
                break;
            case "yellow":
                setTimeout(() => yellow.toggleClass("muteYellow yellow"),500);
                yellow.toggleClass("muteYellow yellow");
                break;
            case "green":
                setTimeout(() => green.toggleClass("muteGreen green"),500);
                green.toggleClass("muteGreen green");
                break;
        }

};
let showSimonArray = () => {
    let i = 0;
    let timer = setInterval(function(){
        simonGame(simonArray[i]);
        i++;
        if (i >= simonArray.length) {
            clearInterval(timer);
        }
    }, 1000)
};

let checkSimon = () => {
    let randomColor = "";
    if (simonArray.length === 0){
        randomColor = getRandomColor();
        simonArray.push(randomColor);
        showSimonArray();
    }
    for(let i = 0; i < simonCheck.length; i++) {
        console.log(`clicked: ${simonCheck}
        simon: ${simonArray}`);
        if(simonCheck[i] !== simonArray[i]){
            $("#html").text("Game Over!");
            $("button").show();
            red.off();
            yellow.off();
            blue.off();
            green.off();
            break;
        }
        if((simonCheck[i] === simonArray[i] && simonCheck.length === simonArray.length)){
            simonCheck = [];
            randomColor = getRandomColor();
            simonArray.push(randomColor);
            showSimonArray();
        }
    }
};
checkSimon();

</script>
</body>
</html>